<% provide(:title, 'Messages') %>

<div class="row">
	<div class="col-lg-12">
		<h1><i class="fa fa-envelope"></i> <%= current_user.name %>'s Message Box</h1>
		<legend></legend>
	</div>
</div>
<div class="container">
	<div class="row">
		<div class="col-md-2">
			<div class="list-group">
				<a href="<%= received_messages_path %>" class="list-group-item"> 
					received <% if unread(current_user) != 0 then %> <span class="badge"><%= unread(current_user) %></span><% end %>
				</a>
				<a href="<%= sent_messages_path %>" class="list-group-item"> sent </a>
				<a href="<%= message_show_path %>" class="list-group-item"> New Message </a>
			</div>
		</div>

		<div class="col-sm-9 col-md-10">

			<div class="panel panel-success">
				<div class="panel-heading">
					<h3 class="panel-title"><i class="fa fa-envelope"></i> send</h3>
				</div>
				<div class="panel-body">
					<table class="table table-condensed table-hover">
						<thead>
							<tr>
								<th class="span2"></th>
								<th class="span2"></th>
								<th class="span2"></th>
								<th class="span2"></th>
							</tr>
						</thead>
						<tbody>
							<% if @received_messages.any? %>
							<% @received_messages.each do |msg| %>							
							<tr data-href="<%= received_message_detail_path(msg.id) %>">
								<td> <% if msg.read_flg==0 then %> <span class="badge">new</span> <% end %> </td>
								<td><a href="<%= received_message_detail_path(msg.id) %>"><i class="fa fa-search"></i></a><td>
								<td><%= gravatar_for msg.post_to, size: 30 %><%= msg.user.name %></td>
								<td><span class="badge"><%= msg.created_at %></span><td>									
							</tr>

							<% end %>
							<% else %>
							not messages
							<% end %>
						</tbody>
						
					</table>
					<%= will_paginate @received_messages,:renderer => BootstrapPagination::Rails %>
				</div>
			</div>
		</div>
	</div>
</div>
